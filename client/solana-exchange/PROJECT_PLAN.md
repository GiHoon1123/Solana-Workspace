# Solana Exchange - 서비스 기획서

**작성일**: 2025/11/24  
**제작자**: Dustin

---

## 서비스 개요

Solana 전용 하이브리드 거래소입니다. CEX(중앙화 거래소)와 DEX 어그리게이터의 기능을 결합한 플랫폼으로, USDT를 기준 통화로 사용하며 Solana 생태계의 자산들을 거래할 수 있습니다.

---

## 핵심 기능

### 1. 자산 거래

- **거래 기준**: USDT (기준 통화)
- **지원 자산**: SOL 및 Solana 생태계 토큰들
- **거래 발생 위치**:
  - **거래소 (CEX)**: 사용자 간 주문 매칭으로 거래 발생
  - **DEX 스왑**: Jupiter 어그리게이터를 통한 외부 DEX 거래 발생
- **거래 방식**:
  - **CEX 방식**: 내부 오더북에서 다른 사용자와 매칭
  - **어그리게이터 방식**: 외부 DEX를 통한 즉시 스왑

### 2. 입금 (Deposit)

- 사용자 지갑으로 자산 입금 가능
- 입금된 자산은 자동으로 모지갑으로 이동
- 입금 확인 후 사용자 잔고에 반영

### 3. 출금 (Withdrawal)

- 보유 자산을 외부 지갑으로 출금 가능
- 모지갑에서 사용자가 지정한 주소로 전송
- 출금 수수료 적용

### 4. 스왑 (Swap)

- Jupiter DEX 어그리게이터 활용
- 여러 DEX에서 최적 가격 조회
- 슬리피지 설정 가능
- 견적 확인 후 스왑 실행

### 5. 오더북 거래

- 매수/매도 주문 생성
- 오더북에서 주문 매칭
- 체결 시 즉시 잔고 반영

---

## 사용자 플로우

### 시나리오 1: SOL 구매 - 거래소 (CEX 방식)

**거래 발생 위치**: 거래소 내부 (사용자 간 거래)

1. 사용자가 SOL 구매 주문 생성 (예: 100 USDT로 SOL 구매)
2. 시스템이 오더북에서 매칭되는 매도 주문 검색
3. 매칭 성공 시 즉시 체결 (거래소에서 거래 발생)
4. 사용자 잔고 업데이트: USDT 차감, SOL 증가

### 시나리오 2: SOL 구매 - DEX 스왑 (어그리게이터 방식)

**거래 발생 위치**: 외부 DEX (Jupiter를 통해)

1. 사용자가 SOL 구매 요청 (오더북에 매칭되는 주문 없거나 즉시 스왑 원할 시)
2. Jupiter API로 여러 DEX에서 최적 가격 견적 조회
3. 사용자가 견적 확인 및 슬리피지 설정
4. 스왑 실행 (외부 DEX에서 거래 발생)
5. 사용자 잔고 업데이트

### 시나리오 3: 자산 입금

1. 사용자가 입금 주소 생성 요청
2. 시스템이 입금 주소 제공
3. 사용자가 외부 지갑에서 입금
4. 시스템이 입금 감지 및 확인
5. 입금된 자산이 모지갑으로 자동 이동
6. 사용자 잔고에 반영

### 시나리오 4: 자산 출금

1. 사용자가 출금 요청 (주소, 수량 입력)
2. 시스템이 잔고 확인
3. 모지갑에서 사용자 지정 주소로 전송
4. 사용자 잔고 차감

---

## 비즈니스 규칙

### 잔고 관리

- 모든 거래는 USDT 기준으로 계산
- 사용자 잔고는 서버 DB에서 관리 (오프체인)
- 실제 자산은 모지갑에서 보관

### 거래 우선순위 및 선택

- **옵션 1: 거래소 거래 (CEX)**
  - 내부 오더북에서 다른 사용자와 매칭
  - 거래 발생: 거래소 내부
  - 장점: 수수료 저렴, 거래 속도 빠름 (DB만 업데이트)
- **옵션 2: DEX 스왑 (어그리게이터)**
  - Jupiter를 통해 외부 DEX 최적 가격 활용
  - 거래 발생: 외부 DEX
  - 장점: 최적 가격, 다양한 유동성 활용

사용자는 원하는 방식 선택 가능하며, 거래소에 매칭되는 주문이 없을 경우 자동으로 DEX 스왑으로 안내될 수 있습니다.

### 수수료

- 거래 수수료: 거래 금액의 일정 비율
- 출금 수수료: 고정 또는 네트워크 수수료

### 스왑

- 현재: DB 시뮬레이션 (실제 블록체인 거래 없음)
- 향후: Jupiter 유료 버전 연동 시 실제 스왑 가능

---

## 서비스 특징

### 하이브리드 구조

- CEX와 DEX의 장점 결합
- 내부 유동성 + 외부 DEX 유동성 활용

### Solana 전용

- Solana 생태계의 모든 토큰 지원
- 빠른 거래 처리 (Solana 네트워크 특성 활용)

### 사용자 친화적

- 직관적인 UI/UX
- 실시간 가격 정보
- 다양한 거래 방식 제공

---

## 제한사항

- 현재는 학습/연구 목적의 프로젝트
- 실제 상용 서비스가 아니므로 실제 사용자 유동성 부족
- 스왑 기능은 DB 시뮬레이션 모드 (향후 실제 스왑 가능)
